import os
import docx
from cryptography.fernet import Fernet

# Path to the encrypted Word file
file_path = os.path.join(os.path.expanduser("~"), "Desktop", "notepadfile.txt")
print(file_path)
# Encryption key used to encrypt the file
key = b"mteGQ2oTDygOAZyGmzrx9xcKLpffPCvuo1j75mLPD1U"

# Initialize a Fernet object with the key
fernet = Fernet(key)

# Open the encrypted Word file
with open(file_path, "rb") as f:
    encrypted_bytes = f.read()

# Decrypt the encrypted data using Fernet
doc_bytes = fernet.decrypt(encrypted_bytes)

# Save the decrypted data to a temporary file
temp_file = "temp.docx"
with open(temp_file, "wb") as f:
    f.write(doc_bytes)

# Open the temporary file using docx
document = docx.Document(temp_file)

# Print the decrypted document's text
print("Decrypted document:")
for paragraph in document.paragraphs:
    print(paragraph.text)

# Delete the temporary file
os.remove(temp_file)
